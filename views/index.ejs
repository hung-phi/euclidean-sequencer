<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title>Euclidian Sequencer</title>
        <link rel="stylesheet" type="text/css" href="css/switches.css" />
        <link rel="stylesheet" type="text/css" href="css/main.css" />


        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://unpkg.com/@webcomponents/webcomponentsjs@^2/webcomponents-bundle.js"></script>
        <script src="https://unpkg.com/tone"></script>
        <script src="https://unpkg.com/@tonejs/ui"></script>

        <script type="text/javascript" src="js/sound.js"></script>
        <script type="text/javascript" src="js/arrange_radial.js"></script>
        <script type="text/javascript" src="js/voice_display.js"></script>


    </head>
    <body>
      <div id="controls-container">
        <div id="controls">
          <h1><u>Euclidian Sequencer</u></h1>
          <h2>Ethan Rountree, Phi Nguyen, Porter Libby</h2>
          <div id='controlbtns'>
            <button id="general_btn" class='btn_control' type="button">General</button>
            <%for (var i = 1; i < numCycles+1; i++){%>
                <button id="v<%=i%>_btn" class='btn_control' type="button" >Voice<%=i%></button>
            <%}%>
            <!-- <button id="v1_btn" class='btn_control' type="button" >Voice1</button>
            <button id="v2_btn" class='btn_control' type="button">Voice2</button>
            <button id="v3_btn" class='btn_control' type="button">Voice3</button> -->
          </div>
          <div id='general'>
            <div id="playpause_container">
              <button class='playpause'></button>
            </div>
            <label for="steps_num">STEPS PER MEASURE</label>
            <input type="range" id="step_val"class="slider" name="steps_num" min="0" max="16" value="1" step="1"
              oninput="populateAll()"
              onchange="populateAll()">

            <label for="tempo_num">TEMPO</label>
            <input type="range" class="slider" id = "tempo_val" name="tempo_num" min="0" max="16" value="1" step="1"
              oninput=""
              onchange="">
          </div>
          <%for (var i = 1; i < numCycles+1;i++){ %>
              <div id="voice<%=i%>">
                <h3>Voice <%=i%></h3>
                <div class='keyboard'>
                    <div class="whitekey" onclick="updatePitchWrapper(this,0,0)"><p>C</p></div>
                    <div class="blackkey" onclick="updatePitchWrapper(this,1,0)"><p>C#</p></div>
                    <div class="whitekey" onclick="updatePitchWrapper(this,2,0)"><p>D</p></div>
                    <div class="blackkey" onclick="updatePitchWrapper(this,3,0)"><p>D#</p></div>
                    <div class="whitekey" onclick="updatePitchWrapper(this,4,0)"><p>E</p></div>
                    <div class="whitekey" onclick="updatePitchWrapper(this,5,0)"><p>F</p></div>
                    <div class="blackkey" onclick="updatePitchWrapper(this,6,0)"><p>F#</p></div>
                    <div class="whitekey" onclick="updatePitchWrapper(this,7,0)"><p>G</p></div>
                    <div class="blackkey" onclick="updatePitchWrapper(this,8,0)"><p>G#</p></div>
                    <div class="whitekey" onclick="updatePitchWrapper(this,9,0)"><p>A</p></div>
                    <div class="blackkey" onclick="updatePitchWrapper(this,10,0)"><p>A#</p></div>
                    <div class="whitekey" onclick="updatePitchWrapper(this,11,0)"><p>B</p></div>
                </div>
                <div class="onoffswitch">
                  <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="voice<%=i%>switch"
                    onchange="voiceToggle(this, 'circle<%=i%>')" checked>
                  <label class="onoffswitch-label" for="voice1switch">
                    <span class="onoffswitch-inner"></span>
                    <span class="onoffswitch-switch"></span>
                  </label>
                </div>
                <label for="dot_num1">Pulses per measure</label>
                <input type="range" id="pulse_val_<%=i%>" class="slider" name="dot_num<%=i%>" min="0" max="16" value="1" step="1"
                  oninput="populateAll()"
                  onchange="populateAll()">
              </div>
          <%}%>
          <!-- <div id="voice1">
            <h3>Voice 1</h3>
            <div class='keyboard'>
                <div class="whitekey" onclick="updatePitchWrapper(this,0,0)"><p>C</p></div>
                <div class="blackkey" onclick="updatePitchWrapper(this,1,0)"><p>C#</p></div>
                <div class="whitekey" onclick="updatePitchWrapper(this,2,0)"><p>D</p></div>
                <div class="blackkey" onclick="updatePitchWrapper(this,3,0)"><p>D#</p></div>
                <div class="whitekey" onclick="updatePitchWrapper(this,4,0)"><p>E</p></div>
                <div class="whitekey" onclick="updatePitchWrapper(this,5,0)"><p>F</p></div>
                <div class="blackkey" onclick="updatePitchWrapper(this,6,0)"><p>F#</p></div>
                <div class="whitekey" onclick="updatePitchWrapper(this,7,0)"><p>G</p></div>
                <div class="blackkey" onclick="updatePitchWrapper(this,8,0)"><p>G#</p></div>
                <div class="whitekey" onclick="updatePitchWrapper(this,9,0)"><p>A</p></div>
                <div class="blackkey" onclick="updatePitchWrapper(this,10,0)"><p>A#</p></div>
                <div class="whitekey" onclick="updatePitchWrapper(this,11,0)"><p>B</p></div>
            </div>
            <div class="onoffswitch">
              <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="voice1switch"
                onchange="voiceToggle(this, 'circle1')" checked>
              <label class="onoffswitch-label" for="voice1switch">
                <span class="onoffswitch-inner"></span>
                <span class="onoffswitch-switch"></span>
              </label>
            </div>
            <label for="dot_num1">Pulses per measure</label>
            <input type="range" id="pulse_val_one" class="slider" name="dot_num1" min="0" max="16" value="1" step="1"
              oninput="populateAll()"
              onchange="populateAll()">
          </div>
          <div id="voice2">
            <h3>Voice 2</h3>
            <div class='keyboard'>
              <div class="whitekey" onclick="updatePitchWrapper(this,0,1)"><p>C</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,1,1)"><p>C#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,2,1)"><p>D</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,3,1)"><p>D#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,4,1)"><p>E</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,5,1)"><p>F</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,6,1)"><p>F#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,7,1)"><p>G</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,8,1)"><p>G#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,9,1)"><p>A</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,10,1)"><p>A#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,11,1)"><p>B</p></div>
            </div>
            <div class="onoffswitch">
              <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="voice2switch"
                onchange="voiceToggle(this, 'circle2')" checked>
              <label class="onoffswitch-label" for="voice2switch">
                <span class="onoffswitch-inner"></span>
                <span class="onoffswitch-switch"></span>
              </label>
            </div>
            <label for="dot_num2">Pulses per measure</label>
            <input type="range" id="pulse_val_two" class="slider" name="dot_num2" min="0" max="16" value="1" step="1"
              oninput="populateAll()"
              onchange="populateAll()">
          </div>
          <div id="voice3">
            <h3>Voice 3</h3>
            <div class='keyboard'>
              <div class="whitekey" onclick="updatePitchWrapper(this,0,2)"><p>C</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,1,2)"><p>C#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,2,2)"><p>D</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,3,2)"><p>D#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,4,2)"><p>E</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,5,2)"><p>F</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,6,2)"><p>F#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,7,2)"><p>G</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,8,2)"><p>G#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,9,2)"><p>A</p></div>
              <div class="blackkey" onclick="updatePitchWrapper(this,10,2)"><p>A#</p></div>
              <div class="whitekey" onclick="updatePitchWrapper(this,11,2)"><p>B</p></div>
            </div>
            <div class="onoffswitch">
              <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="voice3switch"
                onchange="voiceToggle(this, 'circle3')" checked>
              <label class="onoffswitch-label" for="voice3switch">
                <span class="onoffswitch-inner"></span>
                <span class="onoffswitch-switch"></span>
              </label>
            </div>
            <label for="dot_num3">Pulses per measure</label>
            <input type="range" id="pulse_val_three" class="slider" name="dot_num3" min="0" max="16" value="1" step="1"
              oninput="populateAll()"
              onchange="populateAll()">
          </div> -->
        </div>
      </div>

      <div id='vis_container'>
        <div id='step_counter'>0</div>
        <%for (var i = 1; i< numCycles+1;i++){%>
            <div id="circle<%=i%>">
              <div id="dot<%=i%>" class="dot"></div>
            </div>
        <%}%>
        <!-- <div id="circle1">
          <div id="dot1" class="dot"></div>
        </div>

        <div id="circle2">
          <div id="dot2" class="dot"></div>
        </div>

        <div id="circle3">
          <div id="dot3" class="dot"></div>
        </div> -->
      </div>



      <script>
      <%for (var i = 1; i  < numCycles + 1; i++){%>
          arrange("circle<%=i%>");
          $("#voice<%=i%>").slideUp();
          $("#v<%=i%>_btn").click(function(){
              // $("#voice<%=i%>").slideDown();
              <%for (var j = 1; j < numCycles + 1; j++){%>//toggle voice1
                  <%if (i == j){%>
                      $("#voice<%=j%>").slideDown();
                  <%}else{%>
                      $("#voice<%=j%>").slideUp();
                  <%}%>

              <%}%>
              $("#general").slideUp();
          });
      <%}%>
        // arrange('circle1');
        // arrange('circle2');
        // arrange('circle3');
        // $("#voice1").slideUp();
        // $("#voice2").slideUp();
        // $("#voice3").slideUp();
        // $("#general").slideUp();
        //
        // $("#v1_btn").click(function(){ //toggle voice1
        //     $("#voice1").slideDown();
        //     $("#voice2").slideUp();
        //     $("#voice3").slideUp();
        //     $("#general").slideUp();
        // });
        //
        // $("#v2_btn").click(function(){ //toggle voice1
        //     $("#voice1").slideUp();
        //     $("#voice2").slideDown();
        //     $("#voice3").slideUp();
        //     $("#general").slideUp();
        // });
        //
        // $("#v3_btn").click(function(){ //toggle voice1
        //     $("#voice1").slideUp();
        //     $("#voice2").slideUp();
        //     $("#voice3").slideDown();
        //     $("#general").slideUp();
        // });

        $("#general_btn").click(function(){ //toggle voice1
            <%for (var i = 1; i < numCycles; i ++){%>
                $("#voice<%=i%>").slideUp();
            <%}%>
            // $("#voice1").slideUp();
            // $("#voice2").slideUp();
            // $("#voice3").slideUp();
            $("#general").slideDown();
        });

        $(document).ready(function() {
          var btn = $(".playpause");
          btn.click(function() {
            console.log(btn);
            if (btn[0].classList.contains('paused')){
              btn[0].classList.remove('paused');
              Tone.Transport.stop();
            }else{
              btn[0].classList.add('paused');
              Tone.Transport.start();
            }
            return false;
          });
        });

      </script>
    </body>
</html>
